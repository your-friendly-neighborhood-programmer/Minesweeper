<!DOCTYPE html>
<html>
    <head>
        <title>Minesweeper</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
            
            :root {
                --neon-green: #39ff14;
                --cyber-blue: #0ff0fc;
                --cyber-purple: #d300c4;
                --dark-bg: #121212;
                --grid-bg: #1e1e2f;
                --cell-bg: #2a2a3a;
            }
            
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                touch-action: manipulation;
            }
            
            body {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                background-color: var(--dark-bg);
                color: var(--cyber-blue);
                font-family: 'Orbitron', sans-serif;
                padding: 10px;
                text-shadow: 0 0 5px var(--cyber-blue);
            }
            
            h1 {
                color: var(--neon-green);
                margin-bottom: 10px;
                font-size: clamp(1.8rem, 5vw, 3rem);
                text-transform: uppercase;
                letter-spacing: 3px;
                text-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green);
                text-align: center;
            }
            
            .options {
                margin: 10px 0;
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                gap: 5px;
            }
            
            button#newGame {
                background-color: var(--cyber-purple);
                color: #fff;
                border: 2px solid var(--cyber-blue);
                padding: 8px 16px;
                cursor: pointer;
                font-family: 'Orbitron', sans-serif;
                font-weight: bold;
                text-transform: uppercase;
                letter-spacing: 1px;
                box-shadow: 0 0 10px var(--cyber-purple);
                transition: all 0.3s;
                border-radius: 3px;
                font-size: 0.9rem;
            }
            
            button#newGame:hover {
                background-color: var(--cyber-blue);
                box-shadow: 0 0 15px var(--cyber-blue);
                color: var(--dark-bg);
                transform: scale(1.05);
            }
            
            button#flagToggle {
                background-color: var(--cyber-blue);
                color: #fff;
                border: 2px solid var(--cyber-purple);
                padding: 8px 16px;
                cursor: pointer;
                font-family: 'Orbitron', sans-serif;
                font-weight: bold;
                text-transform: uppercase;
                letter-spacing: 1px;
                box-shadow: 0 0 10px var(--cyber-blue);
                transition: all 0.3s;
                border-radius: 3px;
                font-size: 0.9rem;
            }
            
            button#flagToggle.active {
                background-color: var(--neon-green);
                color: var(--dark-bg);
                box-shadow: 0 0 15px var(--neon-green);
            }
            
            .info {
                display: flex;
                justify-content: space-around;
                flex-direction: column;
                align-items: center;
                margin: 10px 0;
                padding: 10px;
                border: 1px solid var(--cyber-blue);
                box-shadow: 0 0 10px var(--cyber-blue);
                border-radius: 5px;
                background-color: rgba(15, 240, 252, 0.1);
                width: 100%;
                max-width: 600px;
            }
            
            .info-row {
                display: flex;
                width: 100%;
                flex-wrap: wrap;
                justify-content: space-around;
            }
            
            .info p {
                margin: 5px;
                font-size: clamp(0.8rem, 3vw, 1.1rem);
                letter-spacing: 1px;
            }
            
            #level {
                color: var(--neon-green);
            }
            
            #mines {
                color: var(--cyber-purple);
            }
            
            canvas {
                cursor: pointer;
                border: 3px solid var(--cyber-blue);
                box-shadow: 0 0 20px var(--cyber-purple), inset 0 0 20px var(--cyber-blue);
                border-radius: 5px;
                max-width: 100%;
                height: auto;
                touch-action: none;
            }
            
            #game-container {
                width: 100%;
                max-width: 600px;
                overflow: hidden;
                margin: 0 auto;
            }
            
            details {
                width: 100%;
                max-width: 600px;
                margin: 10px 0;
                border: 1px solid var(--cyber-blue);
                border-radius: 5px;
                padding: 10px;
                background-color: rgba(15, 240, 252, 0.05);
                box-shadow: 0 0 5px var(--cyber-blue);
                color: var(--cyber-blue);
            }
            
            summary {
                font-family: 'Orbitron', sans-serif;
                font-weight: bold;
                cursor: pointer;
                padding: 5px;
                text-transform: uppercase;
                letter-spacing: 1px;
                color: var(--neon-green);
                text-shadow: 0 0 5px var(--neon-green);
            }
            
            details ul {
                margin-top: 10px;
                margin-left: 20px;
                list-style-type: square;
            }
            
            details li {
                margin: 8px 0;
                line-height: 1.4;
                font-size: clamp(0.8rem, 3vw, 1rem);
            }
            
            .keybind {
                display: inline-block;
                background-color: var(--cyber-purple);
                color: white;
                padding: 2px 8px;
                margin: 0 2px;
                border-radius: 3px;
                border: 1px solid var(--cyber-blue);
                box-shadow: 0 0 5px var(--cyber-purple);
            }
            
            @media (max-width: 600px) {
                body {
                    padding: 5px;
                }
                
                .info p {
                    font-size: 0.85rem;
                }
                
                details li {
                    font-size: 0.8rem;
                }
                
                #canvasSize {
                    font-size: 0.8rem;
                }
            }
        </style>
    </head>
    <body>
        <h1>Minesweeper</h1>
        <div class="info">
            <div class="info-row">
                <p id="level">Level: 1</p>
                <p id="flags">Flags: 0</p>
            </div>
            <div class="info-row">
                <p id="mines">Mines: 0</p>
                <p id="timer">Time: 0s</p>
            </div>
        </div>
        <div class="options">
            <button id="newGame">New Game</button>
            <button id="flagToggle">Flag Mode: Off</button>
        </div>
        
        <div id="game-container">
            <canvas id="minesweeperCanvas" width="600" height="600"></canvas>
        </div>
        <details>
            <summary>How To Play</summary>
            <ul>
                <li><strong>Objective:</strong> Find all mines without clicking on any of them. Progress through increasingly difficult levels.</li>
                <li><strong>Mobile:</strong> Tap a cell to reveal it or toggle "Flag Mode" to place flags instead.</li>
                <li><strong>Desktop:</strong> Left-click to reveal, right-click to flag.</li>
                <li><strong>Numbers</strong> on revealed cells indicate how many mines are in the adjacent cells.</li>
                <li><strong>Cells with 0</strong> neighboring mines will automatically reveal surrounding cells.</li>
                <li><strong>To win:</strong> Correctly mark all mines with flags or reveal all non-mine cells.</li>
                <li><strong>Difficulty:</strong> Each level increases the number of mines by 5, starting with 20 mines at Level 1.</li>
            </ul>
        </details>
        <footer>
            <p>Created by: <a href="https://github.com/your-friendly-neighborhood-programmer">your-friendly-neighborhood-programmer</a></p>
        </footer>
        
        <script>
            const canvas = document.getElementById("minesweeperCanvas");
            const ctx = canvas.getContext("2d");
            const gameGrid = [];
            let level = 1;
            let mines = 15 + (level * 5);
            let timerInterval = null;
            let flagMode = false;
            let squareWidth = 30;
            let gridSize = 20;
            let gridWidth = 20;
            let gridHeight = 20;
            function resizeCanvas() {
                const container = document.getElementById('game-container');
                const containerWidth = container.clientWidth;
                if (window.innerWidth <= 768) {
                    gridWidth = 16;
                    gridHeight = 25;
                    
                    squareWidth = containerWidth / gridWidth;
                    if (window.innerWidth > 400) {
                        squareWidth = Math.min(squareWidth, 30);
                    }
                } else {
                    gridWidth = 20;
                    gridHeight = 20;
                    squareWidth = 30;
                }
                gridSize = gridWidth;
                canvas.width = gridWidth * squareWidth;
                canvas.height = gridHeight * squareWidth;
                if (gameGrid.length > 0) {
                    redrawCanvas();
                }
            }
            window.addEventListener('resize', resizeCanvas);
            resizeCanvas();
            function redrawCanvas() {
                ctx.fillStyle = "#1e1e2f";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                for (let y = 0; y < gameGrid.length; y++) {
                    for (let x = 0; x < gameGrid[y].length; x++) {
                        const cell = gameGrid[y][x];
                        if (cell.mine && cell.toggled) {
                            ctx.fillStyle = "#FF1744"; 
                            ctx.fillRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                            ctx.fillStyle = "white";
                            ctx.font = `${squareWidth * 0.7}px Orbitron`;
                            ctx.fillText("💣", (x * squareWidth) + squareWidth * 0.3, (y * squareWidth) + squareWidth * 0.7);
                        } else if (cell.toggled) {
                            ctx.fillStyle = "#101625";
                            ctx.fillRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                            ctx.strokeStyle = "#39ff14";
                            ctx.lineWidth = 1;
                            ctx.strokeRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                            if (cell.neighbors > 0) {
                                ctx.font = `bold ${squareWidth * 0.7}px Orbitron`;
                                if (cell.neighbors === 1) ctx.fillStyle = "#39ff14";  // neon green
                                else if (cell.neighbors === 2) ctx.fillStyle = "#0ff0fc";  // cyan
                                else if (cell.neighbors === 3) ctx.fillStyle = "#d300c4";  // magenta
                                else if (cell.neighbors === 4) ctx.fillStyle = "#7122FA";  // purple
                                else if (cell.neighbors === 5) ctx.fillStyle = "#FF10F0";  // pink
                                else if (cell.neighbors === 6) ctx.fillStyle = "#00FFBA";  // turquoise
                                else if (cell.neighbors === 7) ctx.fillStyle = "#FFFC00";  // yellow
                                else if (cell.neighbors === 8) ctx.fillStyle = "#FF3D00";  // orange
                                ctx.fillText(
                                    cell.neighbors, 
                                    (x * squareWidth) + (squareWidth * 0.4), 
                                    (y * squareWidth) + (squareWidth * 0.7)
                                );
                            }
                        } else if (cell.flagged) {
                            ctx.fillStyle = "#2a304d";
                            ctx.fillRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                            ctx.fillStyle = "#FF10F0";
                            ctx.font = `${squareWidth * 0.7}px Orbitron`;
                            ctx.fillText("🚩", (x * squareWidth) + squareWidth * 0.3, (y * squareWidth) + squareWidth * 0.7);
                        } else {
                            ctx.fillStyle = "#2a2a3a";
                            ctx.fillRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                            ctx.strokeStyle = "#0ff0fc";
                            ctx.lineWidth = 0.5;
                            ctx.strokeRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                        }
                    }
                }
            }
            function draw() {
                ctx.fillStyle = "#1e1e2f";
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                gameGrid.length = 0;
                for (let y = 0; y < gridHeight; y++) {
                    const row = [];
                    for (let x = 0; x < gridWidth; x++) {
                        const mine = false; 
                        const toggled = false;
                        const flagged = false;
                        const neighbors = 0;
                        row.push({x, y, mine, toggled, flagged, neighbors});
                        ctx.fillStyle = "#2a2a3a";
                        ctx.fillRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                        ctx.strokeStyle = "#0ff0fc";
                        ctx.lineWidth = 0.5;
                        ctx.strokeRect((x * squareWidth) + 2, (y * squareWidth) + 2, squareWidth - 4, squareWidth - 4);
                    }
                    gameGrid.push(row);
                }
            }
            document.getElementById("flagToggle").addEventListener('click', () => {
                flagMode = !flagMode;
                document.getElementById("flagToggle").textContent = 
                    flagMode ? "Flag Mode: On" : "Flag Mode: Off";
                document.getElementById("flagToggle").classList.toggle("active", flagMode);
            });
            canvas.addEventListener('click', handleClick);
            canvas.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const col = Math.floor(x / squareWidth);
                const row = Math.floor(y / squareWidth);
                
                if (isValidCell(row, col)) {
                    placeFlag(row, col);
                }
            });
            canvas.addEventListener('touchstart', function(e) {
                e.preventDefault(); 
                const rect = canvas.getBoundingClientRect();
                const touch = e.touches[0];
                const x = touch.clientX - rect.left;
                const y = touch.clientY - rect.top;
                const col = Math.floor(x / squareWidth);
                const row = Math.floor(y / squareWidth);
                if (isValidCell(row, col)) {
                    if (flagMode) {
                        placeFlag(row, col);
                    } else {
                        toggleCell(row, col);
                    }
                }
            }, false);
            
            function isValidCell(row, col) {
                return row >= 0 && row < gridHeight && col >= 0 && col < gridWidth;
            }
            function handleClick(e) {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const col = Math.floor(x / squareWidth);
                const row = Math.floor(y / squareWidth);
                if (isValidCell(row, col)) {
                    if (flagMode) {
                        placeFlag(row, col);
                    } else {
                        toggleCell(row, col);
                    }
                }
            }
            function toggleCell(row, col) {
                if (!isValidCell(row, col)) return;
                const cell = gameGrid[row][col];
                if (cell.flagged || cell.toggled) return;
                cell.toggled = true;
                if (cell.mine) {
                    cell.toggled = true;
                    reveal();
                    setTimeout(() => {
                        alert("Game Over! You hit a mine.");
                        level = 1;
                        document.getElementById("level").innerText = `Level: ${level}`;
                        newGame();
                    }, 500);
                    return;
                }
                redrawCanvas();
                if (cell.neighbors === 0) {
                    if (row > 0) toggleCell(row - 1, col);
                    if (row < gameGrid.length - 1) toggleCell(row + 1, col);
                    if (col > 0) toggleCell(row, col - 1);
                    if (col < gameGrid[row].length - 1) toggleCell(row, col + 1);
                    if (row > 0 && col > 0) toggleCell(row - 1, col - 1);
                    if (row > 0 && col < gameGrid[row].length - 1) toggleCell(row - 1, col + 1);
                    if (row < gameGrid.length - 1 && col > 0) toggleCell(row + 1, col - 1);
                    if (row < gameGrid.length - 1 && col < gameGrid[row].length - 1) toggleCell(row + 1, col + 1);
                }
                checkWin();
            }
            function checkWin() {
                let isWon = true;
                for (let y = 0; y < gridHeight; y++) {
                    for (let x = 0; x < gridWidth; x++) {
                        const cell = gameGrid[y][x];
                        if (cell.mine && !cell.flagged) isWon = false;
                    }
                }
                if (isWon) {
                    setTimeout(() => {
                        alert("You win!");
                        level += 1;
                        document.getElementById("level").innerText = `Level: ${level}`;
                        newGame();
                    }, 100);
                }
            }
            function makeMines() {
                let minesMade = 0;
                while (minesMade < mines) {
                    const xMines = Math.floor(Math.random() * gridWidth);
                    const yMines = Math.floor(Math.random() * gridHeight);
                    if (!gameGrid[yMines][xMines].mine) {
                        gameGrid[yMines][xMines].mine = true;
                        minesMade++;
                    } 
               }
            }
            function getNeighbors() {
                for (let y = 0; y < gridHeight; y++) {
                    for (let x = 0; x < gridWidth; x++) {
                        const cell = gameGrid[y][x];
                        cell.neighbors = 0;
                        if (cell.mine) continue;
                        if (y > 0 && gameGrid[y - 1][x].mine) cell.neighbors++;
                        if (y < gridHeight - 1 && gameGrid[y + 1][x].mine) cell.neighbors++;
                        if (x > 0 && gameGrid[y][x - 1].mine) cell.neighbors++;
                        if (x < gridWidth - 1 && gameGrid[y][x + 1].mine) cell.neighbors++;
                        if (y > 0 && x > 0 && gameGrid[y - 1][x - 1].mine) cell.neighbors++;
                        if (y > 0 && x < gridWidth - 1 && gameGrid[y - 1][x + 1].mine) cell.neighbors++;
                        if (y < gridHeight - 1 && x > 0 && gameGrid[y + 1][x - 1].mine) cell.neighbors++;
                        if (y < gridHeight - 1 && x < gridWidth - 1 && gameGrid[y + 1][x + 1].mine) cell.neighbors++;
                    }
                }
            }
            function reveal() {
                for (let y = 0; y < gridHeight; y++) {
                    for (let x = 0; x < gridWidth; x++) {
                        gameGrid[y][x].toggled = true;
                    }
                }
                redrawCanvas();
            }
            function placeFlag(row, col) {
                const cell = gameGrid[row][col];
                if (cell.toggled) return;
                cell.flagged = !cell.flagged;
                updateFlagCount();
                redrawCanvas();
                checkWin();
            }
            function updateFlagCount() {
                let flagCount = 0;
                for (let y = 0; y < gridHeight; y++) {
                    for (let x = 0; x < gridWidth; x++) {
                        if (gameGrid[y][x].flagged) flagCount++;
                    }
                }
                document.getElementById("flags").innerText = `Flags: ${flagCount}`;
            }
            function timer() {
                if (timerInterval) {
                    clearInterval(timerInterval);
                }
                document.getElementById("timer").innerText = "Time: 0s";
                let time = 0;
                timerInterval = setInterval(() => {
                    time++;
                    document.getElementById("timer").innerText = `Time: ${time}s`;
                }, 1000);
            }
            function newGame() {
                gameGrid.length = 0;
                mines = 15 + (level * 5);
                draw();
                makeMines();
                getNeighbors(); 
                checkWin();
                timer(); 
                flagMode = false;
                document.getElementById("flagToggle").textContent = "Flag Mode: Off";
                document.getElementById("flagToggle").classList.remove("active");
                document.getElementById("flags").innerText = "Flags: 0";
                document.getElementById("mines").innerText = `Mines: ${mines}`;
                document.getElementById("level").innerText = `Level: ${level}`;
            }
            document.getElementById("newGame").addEventListener("click", newGame);
            newGame();
        </script>
    </body>
</html>