<!DOCTYPE html>
<html>
    <head>
        <title>Minesweeper</title>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap');
            
            :root {
                --neon-green: #39ff14;
                --cyber-blue: #0ff0fc;
                --cyber-purple: #d300c4;
                --dark-bg: #121212;
                --grid-bg: #1e1e2f;
                --cell-bg: #2a2a3a;
            }
            
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }
            
            body {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                background-color: var(--dark-bg);
                color: var(--cyber-blue);
                font-family: 'Orbitron', sans-serif;
                padding: 20px;
                text-shadow: 0 0 5px var(--cyber-blue);
            }
            
            h1 {
                color: var(--neon-green);
                margin-bottom: 20px;
                font-size: 3rem;
                text-transform: uppercase;
                letter-spacing: 3px;
                text-shadow: 0 0 10px var(--neon-green), 0 0 20px var(--neon-green);
            }
            
            .options {
                margin: 15px 0;
            }
            
            button#newGame {
                background-color: var(--cyber-purple);
                color: #fff;
                border: 2px solid var(--cyber-blue);
                padding: 10px 20px;
                cursor: pointer;
                font-family: 'Orbitron', sans-serif;
                font-weight: bold;
                text-transform: uppercase;
                letter-spacing: 1px;
                box-shadow: 0 0 10px var(--cyber-purple);
                transition: all 0.3s;
                border-radius: 3px;
            }
            
            button#newGame:hover {
                background-color: var(--cyber-blue);
                box-shadow: 0 0 15px var(--cyber-blue);
                color: var(--dark-bg);
                transform: scale(1.05);
            }
            
            .info {
                display: flex;
                justify-content: space-around;
                flex-direction: column;
                align-items: center;
                margin: 15px 0;
                padding: 10px;
                border: 1px solid var(--cyber-blue);
                box-shadow: 0 0 10px var(--cyber-blue);
                border-radius: 5px;
                background-color: rgba(15, 240, 252, 0.1);
                width: 600px;
            }
            
            .info p {
                margin: 5px 0;
                font-size: 1.1rem;
                letter-spacing: 1px;
            }
            
            #level {
                color: var(--neon-green);
            }
            
            #mines {
                color: var(--cyber-purple);
            }
            
            canvas {
                cursor: pointer;
                border: 3px solid var(--cyber-blue);
                box-shadow: 0 0 20px var(--cyber-purple), inset 0 0 20px var(--cyber-blue);
                border-radius: 5px;
            }
            
            details {
                width: 600px;
                margin: 10px 0;
                border: 1px solid var(--cyber-blue);
                border-radius: 5px;
                padding: 10px;
                background-color: rgba(15, 240, 252, 0.05);
                box-shadow: 0 0 5px var(--cyber-blue);
                color: var(--cyber-blue);
            }
            
            summary {
                font-family: 'Orbitron', sans-serif;
                font-weight: bold;
                cursor: pointer;
                padding: 5px;
                text-transform: uppercase;
                letter-spacing: 1px;
                color: var(--neon-green);
                text-shadow: 0 0 5px var(--neon-green);
            }
            
            details ul {
                margin-top: 10px;
                margin-left: 20px;
                list-style-type: square;
            }
            
            details li {
                margin: 8px 0;
                line-height: 1.4;
            }
            
            .keybind {
                display: inline-block;
                background-color: var(--cyber-purple);
                color: white;
                padding: 2px 8px;
                margin: 0 2px;
                border-radius: 3px;
                border: 1px solid var(--cyber-blue);
                box-shadow: 0 0 5px var(--cyber-purple);
            }
        </style>
    </head>
    <body>
        <h1>Minesweeper</h1>
        <div class="options">
            <button id="newGame">New Game</button>
        </div>
        
        <details>
            <summary>How To Play</summary>
            <ul>
                <li><strong>Objective:</strong> Find all mines without clicking on any of them. Progress through increasingly difficult levels.</li>
                <li><strong>Left-click</strong> on a cell to reveal it. If it's a mine, you lose and restart at Level 1.</li>
                <li><strong>Right-click</strong> on a cell to place or remove a flag where you think a mine is located.</li>
                <li><strong>Numbers</strong> on revealed cells indicate how many mines are in the adjacent cells.</li>
                <li><strong>Cells with 0</strong> neighboring mines will automatically reveal surrounding cells.</li>
                <li><strong>To win:</strong> Correctly mark all mines with flags or reveal all non-mine cells.</li>
                <li><strong>Difficulty:</strong> Each level increases the number of mines by 5, starting with 20 mines at Level 1.</li>
            </ul>
        </details>
        
        <div class="info">
            <p id="level">Level: 1</p>
            <p id="flags">Flags: 0</p>
            <p id="mines">Mines: 0</p>
            <p id="timer">Elapsed Time: 0s</p>
        </div>
        <canvas id="minesweeperCanvas" width="600" height="600"></canvas>
        <script>
            const canvas = document.getElementById("minesweeperCanvas");
            const ctx = canvas.getContext("2d");
            const squareWidth = 30;
            const gridSize = 20;
            const gameGrid = [];
            let level = 1;
            let mines = 15 + (level * 5);
            let timerInterval = null;
            function draw() {
                let x = 0;
                ctx.fillStyle = "#1e1e2f";
                ctx.fillRect(0, 0, 600, 600);
                for (let y = 0; y < gridSize; y++) {
                    const row = [];
                    for (let x = 0; x < gridSize; x++) {
                        const mine = false; 
                        const toggled = false;
                        const flagged = false;
                        const neighbors = 0;
                        row.push({x, y, mine, toggled, flagged, neighbors});
                        ctx.fillStyle = "#2a2a3a";
                        ctx.fillRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                        ctx.strokeStyle = "#0ff0fc";
                        ctx.lineWidth = 0.5;
                        ctx.strokeRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                    }
                    gameGrid.push(row);
                }
            }
            canvas.addEventListener('click', (e) => {
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const col = Math.floor(x / squareWidth);
                const row = Math.floor(y / squareWidth);
                toggleCell(row, col);
            });
            canvas.addEventListener('contextmenu', (e) => {
                e.preventDefault(); 
                const rect = canvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const col = Math.floor(x / squareWidth);
                const row = Math.floor(y / squareWidth);
                placeFlag(row, col);
            });
            function toggleCell(row, col) {
                const cell = gameGrid[row][col];
                if (cell.flagged || cell.toggled) return;
                cell.toggled = true;
                if (cell.mine) {
                    cell.toggled = true;
                    reveal();
                    setTimeout(() => {
                        alert("Game Over! You hit a mine.");
                        level = 1;
                        document.getElementById("level").innerText = `Level: ${level}`;
                        newGame();
                    }, 500); 
                    return;
                }
                if (cell.neighbors === 0) {
                    if (row > 0) toggleCell(row - 1, col);
                    if (row < gameGrid.length - 1) toggleCell(row + 1, col);
                    if (col > 0) toggleCell(row, col - 1);
                    if (col < gameGrid[row].length - 1) toggleCell(row, col + 1);
                    if (row > 0 && col > 0) toggleCell(row - 1, col - 1);
                    if (row > 0 && col < gameGrid[row].length - 1) toggleCell(row - 1, col + 1);
                    if (row < gameGrid.length - 1 && col > 0) toggleCell(row + 1, col - 1);
                    if (row < gameGrid.length - 1 && col < gameGrid[row].length - 1) toggleCell(row + 1, col + 1);
                }
            }
            function animate() {
                let isWon = true;
                for (let y = 0; y < gridSize; y++) {
                    for (let x = 0; x < gridSize; x++) {
                        const cell = gameGrid[y][x];
                        if (cell.mine && cell.toggled) {
                            ctx.fillStyle = "#FF1744"; 
                            ctx.fillRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                            ctx.fillStyle = "white";
                            ctx.font = "20px Orbitron";
                            ctx.fillText("💣", (x * squareWidth) + 10, (y * squareWidth) + 22);
                        } else if (cell.toggled) {
                            ctx.fillStyle = "#101625";
                            ctx.fillRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                            ctx.strokeStyle = "#39ff14";
                            ctx.lineWidth = 1;
                            ctx.strokeRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                            if (cell.neighbors > 0) {
                                ctx.font = "bold 20px Orbitron";
                                if (cell.neighbors === 1) ctx.fillStyle = "#39ff14";  // neon green
                                else if (cell.neighbors === 2) ctx.fillStyle = "#0ff0fc";  // cyan
                                else if (cell.neighbors === 3) ctx.fillStyle = "#d300c4";  // magenta
                                else if (cell.neighbors === 4) ctx.fillStyle = "#7122FA";  // purple
                                else if (cell.neighbors === 5) ctx.fillStyle = "#FF10F0";  // pink
                                else if (cell.neighbors === 6) ctx.fillStyle = "#00FFBA";  // turquoise
                                else if (cell.neighbors === 7) ctx.fillStyle = "#FFFC00";  // yellow
                                else if (cell.neighbors === 8) ctx.fillStyle = "#FF3D00";  // orange
                                ctx.fillText(cell.neighbors, (x * squareWidth) + 15, (y * squareWidth) + 22);
                            }
                        } else if (cell.flagged) {
                            ctx.fillStyle = "#2a304d";
                            ctx.fillRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                            ctx.fillStyle = "#FF10F0";
                            ctx.font = "20px Orbitron";
                            ctx.fillText("🚩", (x * squareWidth) + 10, (y * squareWidth) + 22);
                        } else {
                            ctx.fillStyle = "#2a2a3a";
                            ctx.fillRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                            ctx.strokeStyle = "#0ff0fc";
                            ctx.lineWidth = 0.5;
                            ctx.strokeRect((x * squareWidth) + 5, (y * squareWidth) + 5, squareWidth - 10, squareWidth - 10);
                        }
                        if (cell.mine && !cell.flagged) isWon = false;
                    }
                }
                if (isWon) {
                    alert("You win!");
                    level += 1;
                    document.getElementById("level").innerText = `Level: ${level}`;
                    newGame();
                }
                requestAnimationFrame(animate);
            }
            function makeMines() {
                let minesMade = 0;
                while (minesMade < mines) {
                    const xMines = Math.floor(Math.random() * gridSize);
                    const yMines = Math.floor(Math.random() * gridSize);
                    if (!gameGrid[yMines][xMines].mine) {
                        gameGrid[yMines][xMines].mine = true;
                        minesMade++;
                    } 
               }
            }
            function getNeighbors() {
                for (let y = 0; y < gridSize; y++) {
                    for (let x = 0; x < gridSize; x++) {
                        const cell = gameGrid[y][x];
                        cell.neighbors = 0;
                        if (cell.mine) continue;
                        if (y > 0 && gameGrid[y - 1][x].mine) cell.neighbors++;
                        if (y < gridSize - 1 && gameGrid[y + 1][x].mine) cell.neighbors++;
                        if (x > 0 && gameGrid[y][x - 1].mine) cell.neighbors++;
                        if (x < gridSize - 1 && gameGrid[y][x + 1].mine) cell.neighbors++;
                        if (y > 0 && x > 0 && gameGrid[y - 1][x - 1].mine) cell.neighbors++;
                        if (y > 0 && x < gridSize - 1 && gameGrid[y - 1][x + 1].mine) cell.neighbors++;
                        if (y < gridSize - 1 && x > 0 && gameGrid[y + 1][x - 1].mine) cell.neighbors++;
                        if (y < gridSize - 1 && x < gridSize - 1 && gameGrid[y + 1][x + 1].mine) cell.neighbors++;
                    }
                }
            }
            function reveal() {
                for (let y = 0; y < gridSize; y++) {
                    for (let x = 0; x < gridSize; x++) {
                        gameGrid[y][x].toggled = true;
                    }
                }
            }
            function placeFlag(row, col) {
                const cell = gameGrid[row][col];
                if (cell.toggled) return;
                cell.flagged = !cell.flagged;
                updateFlagCount();
            }
            function updateFlagCount() {
                let flagCount = 0;
                for (let y = 0; y < gridSize; y++) {
                    for (let x = 0; x < gridSize; x++) {
                        if (gameGrid[y][x].flagged) flagCount++;
                    }
                }
                document.getElementById("flags").innerText = `Flags: ${flagCount}`;
            }
            function timer() {
                if (timerInterval) {
                    clearInterval(timerInterval);
                }
                document.getElementById("timer").innerText = "Elapsed Time: 0s";
                let time = 0;
                timerInterval = setInterval(() => {
                    time++;
                    document.getElementById("timer").innerText = `Elapsed Time: ${time}s`;
                }, 1000);
            }
            function newGame() {
                gameGrid.length = 0;
                mines = 15 + (level * 5);
                draw();
                makeMines();
                getNeighbors(); 
                animate();
                timer(); 
                document.getElementById("flags").innerText = "Flags: 0";
                document.getElementById("mines").innerText = `Mines: ${mines}`;
                document.getElementById("level").innerText = `Level: ${level}`;
            }
            document.getElementById("newGame").addEventListener("click", newGame);
            newGame();
        </script>
    </body>
</html>